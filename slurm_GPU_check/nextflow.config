process {
    executor = 'slurm'
    queue = 'main'                    // Replace with your cluster's GPU queue name
    withName: 'CHECK_GPU' {
            clusterOptions = '--gres=gpu:1'  // Request 1 GPU per task 
    }
    withName: 'CHECK_CPU' {
            cpus = 1
            memory = 2.GB
    }
    withName: 'TEST_GPU_UTILIZATION' {
            clusterOptions = '--gres=gpu:1'  // Request 1 GPU per task
    }
}

// Enable trace reporting
trace {
    enabled = true
    file = "${projectDir}/results/execution_trace.txt"
    overwrite = true
    fields = 'task_id,name,cpu_model,status,exit,realtime,%cpu,rss,gpu_model,gpu_mem_total,gpu_driver,avg_gpu_util,avg_gpu_mem_perc'
}

apptainer {
    enabled = true
    runOptions = '--nv'
}